<!DOCTYPE html>
<html lang="en" class="dark"> <!-- Locked to dark mode -->
<head>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-8LW0XPKLRE"></script>
        <script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());

                  gtag('config', 'G-8LW0XPKLRE');
                </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soulcodes | Cosmic Tools to Escape the Matrix</title>
            
    <!-- SEO Meta Tags -->
    <meta name="description" content="Discover your angel number, track spiritual synchronicities, and draw daily affirmations with Soulcodes - free cosmic tools for spiritual awakening and manifestation. Calculate your personal angel number based on numerology.">
    <meta name="keywords" content="angel number calculator, angel number meaning, track angel numbers, numerology calculator, spiritual awakening tools, daily affirmations, moon phases, soul journal, manifestation tools, spiritual growth, divine synchronicity, angel number tracker">
    <meta name="author" content="Soulcodes">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.soulcodes.site/">
    
    <!-- Open Graph Meta Tags for Social Sharing -->
    <meta property="og:title" content="Soulcodes | Angel Number Calculator & Spiritual Awakening Tools">
    <meta property="og:description" content="Free angel number calculator, tracker, and cosmic tools for spiritual awakening. Discover your personal angel number through numerology and track divine synchronicities.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.soulcodes.site/">
    <meta property="og:site_name" content="Soulcodes">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Soulcodes | Angel Number Calculator & Spiritual Tools">
    <meta name="twitter:description" content="Calculate your angel number, track synchronicities, and access free spiritual awakening tools for manifestation and growth.">
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#0c0a1a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Tailwind CSS CDN (with Typography plugin) -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Lucide Icons CDN (kept for potential future use, though theme icons are removed) -->
    <script src="https://unpkg.com/lucide-react@0.294.0/dist/lucide-react.js"></script>

    <!-- Custom Tailwind Configuration -->
 <script>
  if (typeof tailwind !== 'undefined') {
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            'serif': ['Playfair Display', 'serif'],
            'sans': ['Inter', 'sans-serif'],
          },
          colors: {
            cosmic: {
              purple: '#8e44ad',
              pink: '#ff69b4',
              gold: '#f1c40f',
              midnight: '#0c0a1a',
            }
          },
          textShadow: {
            'glow-white': '0 0 10px rgba(255, 255, 255, 0.7)',
            'glow-gold': '0 0 12px rgba(241, 196, 15, 0.8)',
          },
          animation: {
            'gradient-bg': 'gradient-bg 15s ease infinite',
            'star-blink': 'star-blink 2s infinite ease-in-out alternate',
            'subtle-pulse': 'subtle-pulse 3s infinite ease-in-out',
          },
          keyframes: {
            'gradient-bg': {
              '0%, 100%': { 'background-position': '0% 50%' },
              '50%': { 'background-position': '100% 50%' },
            },
            'star-blink': {
              '0%': { opacity: 0.2 },
              '100%': { opacity: 1 },
            }
          }
        }
      },
      plugins: [
        function ({ addUtilities }) {
          const newUtilities = {
            '.text-shadow-glow-white': {
              textShadow: '0 0 10px rgba(255, 255, 255, 0.7)',
            },
            '.text-shadow-glow-gold': {
              textShadow: '0 0 12px rgba(241, 196, 15, 0.8)',
            },
            '.text-shadow-glow-pink': {
              textShadow: '0 0 12px rgba(255, 105, 180, 0.7)',
            },
            '.perspective-1000': {
              perspective: '1000px',
            },
            '.transform-style-3d': {
              transformStyle: 'preserve-3d',
            },
            '.backface-hidden': {
              backfaceVisibility: 'hidden',
            },
            '.transform-rotate-y-180': {
              transform: 'rotateY(180deg)',
            },
          };
          addUtilities(newUtilities, ['responsive', 'hover']);
        }
      ]
    };
  }
</script>

    <!-- Custom CSS for Card Flip and Starfield (Simplified for Dark Mode only) -->
    <style>
        /* Card Flip */
        .perspective-1000 {
            perspective: 1000px;
        }
        
        .card-container {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 1s;
            transform-style: preserve-3d;
                            cursor: pointer;
            user-select: none;
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            text-align: center;
            border-radius: 1rem;
            border: 2px solid;
        }
        
        .card-front {
            background: linear-gradient(135deg, #0c0a1a 0%, #8e44ad 50%, #ff69b4 100%);
            border-color: rgba(241, 196, 15, 0.5);
        }
        
        .card-back {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            border-color: rgba(255, 105, 180, 0.5);
            transform: rotateY(180deg);
        }
        
        .card-container.flipped {
            transform: rotateY(180deg);
        }
        
        /* Starfield background */
       #stars-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;               /* bring above page background */
    overflow: hidden;
    pointer-events: none;     /* so it doesnâ€™t block clicks */
}

        
        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            animation: star-blink 3s infinite ease-in-out;
        }
        
        @keyframes star-blink {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }
        
        /* Custom scrollbar for a more thematic feel (Dark mode) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0c0a1a; /* cosmic-midnight */
        }
        ::-webkit-scrollbar-thumb {
            background: #8e44ad; /* cosmic-purple */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #ff69b4; /* cosmic-pink */
        }

        /* Fix for hero centering and page scrolling */
        body, html {
            overflow-y: auto !important;
            overflow-x: hidden;
            scroll-behavior: smooth;
            min-height: 100vh;
        }
        
        #hero {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

                    /* Email Status Message Visibility Fix */
        #email-status {
            min-height: 30px;
            padding: 8px 16px;
            margin-top: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            transition: all 0.3s ease;
        }

        #email-status:not(:empty) {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
    </style>
</head>
        <body class="bg-black">

    
    <!-- Structured Data (JSON-LD) for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Soulcodes",
      "alternateName": "Angel Number Calculator & Tracker",
      "url": "https://www.soulcodes.site/",
      "description": "Free angel number calculator and tracker. Discover your personal angel number through numerology, track synchronicities, and access daily spiritual tools for awakening and manifestation.",
      "applicationCategory": "LifestyleApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Angel Number Calculator based on name and birthdate",
        "Angel Number Tracker for logging synchronicities",
        "Daily Affirmation Cards",
        "Moon Phase Tracker",
        "Soul Journal with prompts"
      ],
      "keywords": "angel numbers, numerology, spiritual awakening, manifestation, synchronicity, angel number calculator, angel number meanings",
      "inLanguage": "en-US",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "5.0",
        "reviewCount": "1"
      }
    }
    </script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is an angel number calculator?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "An angel number calculator uses numerology to determine your personal angel number based on your name and birthdate. It applies Pythagorean numerology principles to reveal divine messages and spiritual guidance unique to you."
          }
        },
        {
          "@type": "Question",
          "name": "How do I calculate my angel number?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Enter your full name and birthdate into our free angel number calculator. The tool uses numerology to convert your name letters and birth date into numbers, then reduces them to a single digit or master number (11, 22, 33) that represents your angel number."
          }
        },
        {
          "@type": "Question",
          "name": "What do angel numbers mean?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Angel numbers are repeating number sequences (like 111, 222, 444) that carry spiritual messages from the universe or your angels. Each number has a unique meaning related to guidance, manifestation, spiritual growth, and life purpose."
          }
        },
        {
          "@type": "Question",
          "name": "How can I track angel number sightings?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Use our angel number tracker to log when and where you see angel numbers (on clocks, license plates, receipts). Record the date, time, location, and your thoughts or feelings to identify patterns and understand the divine messages being sent to you."
          }
        }
      ]
    }
    </script>
        

    <!-- ===== Header (Theme Toggle Removed) ===== -->
    <header class="fixed top-0 left-0 w-full p-4 flex justify-between items-center z-50 mix-blend-difference">
        <h1 class="font-serif text-2xl font-bold text-white">
            <a href="#" class="hover:text-cosmic-gold transition-colors">Soulcodes</a>
        </h1>
                        <!-- Navigation Menu -->
        <nav class="hidden md:flex items-center gap-6">
            <a href="#card-deck" class="text-gray-200 hover:text-cosmic-gold transition-colors duration-300">Daily Cards</a>
            <a href="#angel-calculator" class="text-gray-200 hover:text-cosmic-gold transition-colors duration-300">Calculator</a>
                  <a href="#life-path-calculator" class="text-gray-200 hover:text-cosmic-gold transition-colors duration-300">Life Path</a>         
            <a href="#angel-tracker" class="text-gray-200 hover:text-cosmic-gold transition-colors duration-300">Tracker</a>
            <a href="#angel-numbers-guide" class="text-gray-200 hover:text-cosmic-gold transition-colors duration-300">Learn</a>
            <a href="#about" class="text-gray-200 hover:text-cosmic-gold transition-colors duration-300">About</a>
        </nav>
        
        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="md:hidden text-cosmic-gold hover:text-cosmic-pink transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>
            </header>
        
        
<!-- User Profile Collection Modal -->
<div id="profile-modal" class="fixed inset-0 bg-black/80 backdrop-blur-lg z-50 hidden flex items-center justify-center p-6">
    <div class="bg-cosmic-midnight border-2 border-cosmic-gold rounded-2xl p-8 max-w-2xl w-full">
        <h2 class="font-serif text-3xl text-cosmic-gold mb-4 text-center">Create Your Soulcodes Profile</h2>
        <p class="text-gray-300 text-center mb-6">Personalize your spiritual journey</p>
        
        <form id="profile-form" class="space-y-4">
            <div>
                <label class="block text-cosmic-pink mb-2">Your Name</label>
                <input type="text" id="profile-name" required
                    class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
            </div>
            
            <div>
                <label class="block text-cosmic-pink mb-2">Birth Date</label>
                <input type="date" id="profile-birthdate" required
                    class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
            </div>
            
            <div>
                <label class="block text-cosmic-pink mb-2">What are you seeking guidance on?</label>
                <select id="profile-goal" required
                    class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
                    <option value="">Select your focus...</option>
                    <option value="career">Career & Purpose</option>
                    <option value="love">Love & Relationships</option>
                    <option value="spiritual">Spiritual Growth</option>
                    <option value="abundance">Financial Abundance</option>
                    <option value="health">Health & Wellbeing</option>
                    <option value="transformation">Personal Transformation</option>
                </select>
            </div>
            
            <div>
                <label class="block text-cosmic-pink mb-2">Numbers you see frequently (optional)</label>
                <input type="text" id="profile-numbers" placeholder="e.g., 111, 444, 777"
                    class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
            </div>
            
            <button type="submit" 
                class="w-full px-8 py-3 bg-gradient-to-r from-cosmic-pink to-cosmic-purple text-white font-bold rounded-full hover:scale-105 transition-all duration-300">
                Start My Journey
            </button>
        </form>
    </div>
</div>

<main>
        <!-- ===== Hero Section ===== -->
        <section id="hero" class="min-h-screen flex flex-col items-center justify-center text-center p-6 relative bg-gradient-to-b from-black to-cosmic-midnight">
            
    <!-- Mobile Menu Overlay -->
    <div id="mobile-menu" class="md:hidden fixed top-16 left-0 w-full bg-cosmic-midnight/95 backdrop-blur-lg border-b border-cosmic-purple/20 transform -translate-y-full transition-transform duration-300 z-40">
        <nav class="flex flex-col p-6 space-y-4">
            <a href="#card-deck" class="mobile-nav-link text-gray-200 hover:text-cosmic-gold transition-colors duration-300 text-lg">ðŸŽ´ Daily Cards</a>
            <a href="#angel-calculator" class="mobile-nav-link text-gray-200 hover:text-cosmic-gold transition-colors duration-300 text-lg">ðŸ”¢ Calculator</a>
            <a href="#angel-tracker" class="mobile-nav-link text-gray-200 hover:text-cosmic-gold transition-colors duration-300 text-lg">ðŸ“Š Tracker</a>
                      <a href="#life-path-calculator" class="mobile-nav-link text-gray-200 hover:text-cosmic-gold transition-colors duration-300 text-lg">ðŸ”® Life Path</a>
            <a href="#angel-numbers-guide" class="mobile-nav-link text-gray-200 hover:text-cosmic-gold transition-colors duration-300 text-lg">ðŸ“– Learn</a>
            <a href="#about" class="mobile-nav-link text-gray-200 hover:text-cosmic-gold transition-colors duration-300 text-lg">âœ¨ About</a>
        </nav>
    </div>
            <div class="z-10 max-w-4xl mx-auto">
                                <!-- Personalized Greeting (shown when user has profile) -->
            <div id="personalized-greeting" class="hidden mb-6">
                <h2 class="font-serif text-2xl md:text-3xl text-cosmic-gold mb-4 text-center">
                    Welcome back, <span id="user-name-display"></span> âœ¨
                </h2>
                <p class="text-lg text-gray-300 mb-2 text-center">
                    Your Life Path Number: <span id="user-life-path" class="text-cosmic-pink font-bold text-2xl"></span>
                </p>
                <p class="text-md text-gray-400 mb-6 text-center">
                    Days on your journey: <span id="days-since-signup" class="text-cosmic-gold"></span>
                </p>
            </div>

                <h1 class="font-serif text-5xl md:text-7xl font-bold text-shadow-glow-white animate-subtle-pulse">
                    Soulcodes
                </h1>
                <p class="font-serif text-3xl md:text-5xl text-white mt-4 mb-8 text-shadow-glow-pink">
                    Cosmic Tools to Escape the Matrix
                </p>
            <h2 class="font-serif text-3xl md:text-4xl font-bold text-cosmic-gold mb-6">Draw Your Soulcode</h2>
            
            <!-- Email CTA Above the Fold -->
            <p class="text-lg text-gray-200 mb-4 text-center">Get weekly cosmic insights & spiritual guidance delivered to your inbox âœ¨</p>
                <form id="email-signup-form" class="flex flex-col gap-4 items-center w-full">
                                        <input 
                    type="text" 
                    id="name-input" 
                    placeholder="Enter your name" 
                    required
                    class="w-full max-w-md px-6 py-3 rounded-full bg-white/10 border border-cosmic-pink/30 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cosmic-gold focus:border-transparent"
                />
                    <input 
                        type="email" 
                        id="email-input" 
                        placeholder="Enter your email" 
                        required
                        class="w-full max-w-md px-6 py-3 rounded-full bg-white/10 border border-cosmic-pink/30 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cosmic-gold focus:border-transparent"
                    />
                    <button 
                        type="submit" 
                        class="px-8 py-3 bg-gradient-to-r from-cosmic-pink to-cosmic-purple text-white font-bold rounded-full hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-cosmic-pink/50"
                    >
                        Join Free
                    </button>
                </form>
                <p id="email-status" class="text-sm text-center mt-2 text-cosmic-gold"></p>
            </div>
                
        </section>

        <!-- Women-Focused Welcome Banner -->
<section class="pt-24 pb-12 px-6 bg-gradient-to-b from-cosmic-midnight to-black/80">
  <div class="max-w-4xl mx-auto text-center">
    <h1 class="font-serif text-5xl md:text-6xl text-transparent bg-clip-text bg-gradient-to-r from-cosmic-gold to-cosmic-pink mb-6">
      Connect With Your Higher Self
    </h1>
    <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
      A sacred space designed specifically for women to explore cosmic tools, discover your soul purpose, and raise your vibration. 
      Use these divine connections to manifest your highest self.
    </p>
   <div class="flex flex-wrap justify-center gap-4">
  <button
    id="btn-affirmation"
    class="bg-white/10 backdrop-blur-sm rounded-xl px-6 py-3 border border-cosmic-purple/30 hover:border-cosmic-gold/50 transition-all"
  >
    <p class="text-cosmic-gold font-medium">Affirmation Cards</p>
  </button>
  <button
    id="btn-angel-numbers"
    class="bg-white/10 backdrop-blur-sm rounded-xl px-6 py-3 border border-cosmic-pink/30 hover:border-cosmic-gold/50 transition-all"
  >
    <p class="text-cosmic-pink font-medium">Angel Numbers</p>
  </button>
  <button
    id="btn-life-path"
    class="bg-white/10 backdrop-blur-sm rounded-xl px-6 py-3 border border-cosmic-gold/30 hover:border-cosmic-gold/50 transition-all"
  >
    <p class="text-cosmic-gold font-medium">Life Path Insights</p>
  </button>
</div>

  </div>
</section>


        <!-- ===== Interactive Card Deck Section ===== -->
        <section id="card-deck" class="min-h-screen flex flex-col items-center justify-center p-6 bg-black/30 backdrop-blur-sm">
            <h2 class="font-serif text-4xl text-center mb-10 text-shadow-glow-white">Connect With Your Higher Self</h2>
            
            <div class="perspective-1000 w-80 h-[480px] md:w-96 md:h-[560px]">
                <div id="card-container" class="card-container rounded-2xl cursor-pointer">
                    <!-- Card Front -->
                    <div class="card-face card-front">
                        <!-- Sacred Geometry Icon -->
                        <svg class="w-32 h-32 text-cosmic-gold opacity-50 absolute" viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="1">
                           <path d="M50 2.5 L93.3 26.25 V73.75 L50 97.5 L6.7 73.75 V26.25 Z"></path>
                           <path d="M50 2.5 L6.7 26.25 L6.7 73.75 L50 97.5 L93.3 73.75 L93.3 26.25 Z" transform="rotate(30 50 50)"></path>
                           <circle cx="50" cy="50" r="23.75"></circle>
                           <circle cx="50" cy="50" r="47.5"></circle>
                        </svg>

                        <h3 class="font-serif text-3xl font-bold text-shadow-glow-gold z-10">Draw Your Soulcode</h3>
                        <p class="text-lg text-white/80 mt-4 z-10">Click to reveal your message</p>
                    </div>

                    <!-- Card Back -->
                    <div class="card-face card-back">
                        <p id="affirmation-text" class="font-serif text-3xl md:text-4xl text-white text-shadow-glow-white">
                            Your divine message is loading...
                        </p>
                    </div>
                </div>
            </div>

            <button id="draw-new-card-button" class="mt-10 font-sans font-bold text-lg px-8 py-3 bg-cosmic-purple text-white rounded-full shadow-lg transition-all duration-300 ease-in-out
                                                      hover:scale-105 hover:bg-cosmic-pink hover:shadow-cosmic-pink/50">
                Draw a New Card
            </button>
        </section>
        
        <!-- ===== Daily Ritual Dashboard Section ===== -->
        <section id="ritual-dashboard" class="py-20 px-6 bg-cosmic-midnight/50">
            <h2 class="font-serif text-4xl text-center mb-12 text-shadow-glow-white">Your Daily Ritual</h2>
            
            <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
                
                <!-- Moon Phase -->
                <div class="bg-black/30 backdrop-blur-md rounded-2xl p-6 border border-cosmic-purple/50 shadow-xl shadow-cosmic-purple/20 text-center">
                    <h3 class="font-serif text-2xl text-cosmic-gold mb-4">Today's Moon Phase</h3>
                    <div id="moon-phase-icon" class="text-7xl mb-4"></div>
                    <p id="moon-phase-name" class="text-xl font-semibold"></p>
                </div>
                
                <!-- Angel Number -->
                <div class="bg-black/30 backdrop-blur-md rounded-2xl p-6 border border-cosmic-pink/50 shadow-xl shadow-cosmic-pink/20 text-center">
                    <h3 class="font-serif text-2xl text-cosmic-gold mb-4">Angel Number</h3>
                    <p id="angel-number" class="font-serif text-7xl mb-4 text-shadow-glow-white">444</p>
                    <p class="text-lg">A sign of protection & encouragement.</p>
                </div>

                <!-- Journal Prompt -->
                <div class="bg-black/30 backdrop-blur-md rounded-2xl p-6 border border-cosmic-gold/50 shadow-xl shadow-cosmic-gold/20 md:col-span-3">
                    <h3 class="font-serif text-2xl text-cosmic-gold mb-4 text-center">Soul Journal</h3>
                    <p id="journal-prompt" class="text-lg text-center mb-4 italic">What limiting belief am I ready to release today?</p>
                    <textarea id="journal-input" rows="8" class="w-full p-4 rounded-lg bg-white/10 text-white placeholder-gray-500 border-0 focus:ring-2 focus:ring-cosmic-pink" placeholder="Write your reflections..."></textarea>
                    <div class="flex justify-center mt-4">
                        <button id="save-journal-button" class="font-sans font-bold text-md px-6 py-2 bg-cosmic-gold text-cosmic-midnight rounded-full shadow-lg transition-all duration-300 ease-in-out
                                                            hover:scale-105 hover:shadow-cosmic-gold/50">
                            Save My Ritual
                        </button>
                    </div>
                    <p id="save-status" class="text-center mt-3 text-cosmic-pink h-4"></p>
                </div>

            </div>
        </section>

                <!-- ===== Angel Number Calculator Section ===== -->
    <section id="angel-calculator" class="py-20 px-6 bg-black/50">
        <h2 class="font-serif text-4xl text-center mb-12 text-shadow-glow-white">Discover Your Angel Number</h2>
        
        <div class="max-w-2xl mx-auto bg-black/30 backdrop-blur-md rounded-2xl p-8 border border-cosmic-pink/50 shadow-xl shadow-cosmic-pink/20">
            <div class="space-y-6">
                    <label class="block text-lg mb-2 text-cosmic-gold">Your Full Name</label>
                    <input type="text" id="calc-name" placeholder="Enter your full name" 
                           class="w-full p-4 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-pink/30 focus:ring-2 focus:ring-cosmic-gold focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-lg mb-2 text-cosmic-gold">Your Birthdate</label>
                    <input type="date" id="calc-birthdate" 
                           class="w-full p-4 rounded-lg bg-white/10 text-white border border-cosmic-pink/30 focus:ring-2 focus:ring-cosmic-gold focus:border-transparent">
                </div>
                
                <button id="calculate-angel-number" class="w-full font-sans font-bold text-lg px-8 py-4 bg-white/10 backdrop-blur-md border border-cosmic-gold/30 text-white rounded-full shadow-lg transition-all duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-cosmic-gold/50">
                    Calculate My Angel Number
                </button>
                
                <div id="angel-result" class="hidden mt-8 p-6 rounded-xl bg-gradient-to-br from-cosmic-purple/30 to-cosmic-pink/30 border-2 border-cosmic-gold">
                    <div class="text-center">
                        <p class="text-lg text-gray-300 mb-2">Your Personal Angel Number</p>
                        <p id="angel-number-display" class="font-serif text-7xl text-cosmic-gold text-shadow-glow-gold mb-4"></p>
                        <p id="angel-meaning" class="text-gray-200 text-lg"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== Angel Number Tracker Section ===== -->
    <section id="angel-tracker" class="py-20 px-6 bg-cosmic-midnight/50">
        <h2 class="font-serif text-4xl text-center mb-12 text-shadow-glow-white">Track Your Angel Number Sightings</h2>
        
        <div class="max-w-4xl mx-auto">
            <!-- Add New Sighting Form -->
                <h3 class="font-serif text-2xl text-cosmic-gold mb-6">Log a New Sighting</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm mb-2">Angel Number</label>
                        <input type="text" id="sighting-number" placeholder="e.g., 111, 222, 333" 
                               class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-pink">
                    </div>
                    <div>
                        <label class="block text-sm mb-2">Date & Time</label>
                        <input type="datetime-local" id="sighting-datetime" 
                               class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-pink">
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-sm mb-2">Where did you see it?</label>
                    <input type="text" id="sighting-location" placeholder="Clock, license plate, receipt, etc." 
                           class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-pink">
                </div>
                <div class="mb-4">
                    <label class="block text-sm mb-2">Your thoughts or feelings</label>
                    <textarea id="sighting-notes" rows="3" placeholder="What were you thinking about when you saw this number?" 
                              class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-pink"></textarea>
                </div>
                <button id="log-sighting" class="w-full font-sans font-bold text-md px-6 py-3 bg-cosmic-purple text-white rounded-full shadow-lg transition-all duration-300 ease-in-out hover:scale-105 hover:bg-cosmic-pink hover:shadow-cosmic-pink/50">
                   Save Sighting
                </button>
            </div>

            <!-- Sightings List -->
            <div class="bg-black/30 backdrop-blur-md rounded-2xl p-8 border border-cosmic-gold/50 shadow-xl shadow-cosmic-gold/20">
                <h3 class="font-serif text-2xl text-cosmic-gold mb-6">Your Angel Number Journal</h3>
                <div id="sightings-list" class="space-y-4">
                    <p class="text-gray-400 text-center italic">No sightings recorded yet. Start tracking your divine messages!</p>
                </div>
            </div>
        </div>
    </section>

          <!-- ===== Life Path Calculator Section ===== -->
  <section id="life-path-calculator" class="py-20 px-6 bg-black/30 backdrop-blur-sm">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="font-serif text-4xl mb-6 text-shadow-glow-white">Discover Your Life Path Number</h2>
      <p class="text-lg text-gray-200 mb-8">Your Life Path Number reveals your life's purpose, challenges, and destiny. Calculate yours now and unlock deeper insights into your soul's journey.</p>

      <!-- Life Path Calculator Form -->
      <div class="bg-black/40 rounded-2xl p-8 border border-cosmic-purple/50 shadow-xl">
        <h3 class="font-serif text-2xl text-cosmic-gold mb-6">Free Life Path Calculator</h3>

        <div class="space-y-4 mb-6">
          <input
            type="text"
            id="lifepath-name"
            placeholder="Enter your full name"
            class="w-full p-4 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-pink/30 focus:ring-2 focus:ring-cosmic-gold focus:border-transparent"
          />

          <input
            type="date"
            id="lifepath-birthdate"
            class="w-full p-4 rounded-lg bg-white/10 text-white border border-cosmic-pink/30 focus:ring-2 focus:ring-cosmic-gold focus:border-transparent"
          />
        </div>

        <button
          id="calculate-life-path"
          class="px-8 py-3 bg-gradient-to-r from-cosmic-pink to-cosmic-purple text-white font-bold rounded-full hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-cosmic-pink/50"
        >
          Calculate My Life Path
        </button>

        <!-- Results -->
        <div id="lifepath-result" class="mt-8 hidden">
          <div class="bg-gradient-to-br from-cosmic-purple/20 to-cosmic-pink/20 rounded-xl p-6 border border-cosmic-gold/50">
            <h4 class="font-serif text-3xl text-cosmic-gold mb-4">Your Life Path Number</h4>
            <div class="font-serif text-7xl text-white text-shadow-glow-gold mb-4" id="lifepath-number"></div>
            <p id="lifepath-meaning" class="text-lg text-gray-200 mb-6"></p>

            <!-- CTA with Affiliate Link -->
            <div class="mt-6 p-6 bg-black/40 rounded-xl border border-cosmic-gold/30">
              <h5 class="font-serif text-xl text-cosmic-gold mb-3">ðŸŒŸ Want Your Complete Numerology Reading?</h5>
              <p class="text-gray-300 mb-4">Discover your destiny, soul urge, and personality numbers with a comprehensive personalized numerology report</p>
              <a
                href="https://0367064vrdocny1i0kmfqj2994.hop.clickbank.net"
                target="_blank"
                rel="noopener noreferrer"
                class="inline-block px-8 py-3 bg-gradient-to-r from-cosmic-gold to-yellow-500 text-cosmic-midnight font-bold rounded-full hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-cosmic-gold/50"
              >
                Get Your Full Reading â†’
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

        <!-- ===== About Section ===== -->
        <section id="about" class="py-20 px-6 text-center max-w-3xl mx-auto">
            <h2 class="font-serif text-4xl mb-6 text-shadow-glow-white">This is Your Sanctuary</h2>
            <div class="prose prose-lg text-gray-300 mx-auto font-sans">
                <p>
    <!-- ===== SEO Content Section - Understanding Angel Numbers ===== -->
    <section id="angel-numbers-guide" class="py-20 px-6 bg-cosmic-midnight/70">
        <div class="max-w-4xl mx-auto">
            <h2 class="font-serif text-4xl text-center mb-12 text-shadow-glow-white">Understanding Angel Numbers and Their Meanings</h2>

            <div class="space-y-6 text-gray-200 leading-relaxed">
                <p class="text-lg">
                    Angel numbers are powerful sequences of numbers that carry divine guidance and spiritual messages from the universe. When you repeatedly see numbers like 111, 222, 333, or 444, it's not a coincidenceâ€”it's a form of synchronicity that holds deep meaning for your spiritual journey.
                </p>

                <h3 class="font-serif text-2xl text-cosmic-gold mt-8 mb-4">How to Use Our Free Angel Number Calculator</h3>
                <p>
                    Our angel number calculator uses the ancient art of numerology to determine your personal angel number based on your full name and birthdate. By applying Pythagorean numerology principles, we convert the letters in your name and the digits in your birthdate into numbers, then reduce them to reveal your unique angel numberâ€”including powerful master numbers like 11, 22, and 33.
                </p>

                <h3 class="font-serif text-2xl text-cosmic-gold mt-8 mb-4">Common Angel Number Meanings</h3>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li><strong class="text-cosmic-pink">111:</strong> New beginnings and manifestation - Your thoughts are rapidly becoming reality</li>
                    <li><strong class="text-cosmic-pink">222:</strong> Balance and harmony - Trust in divine timing and maintain faith</li>
                    <li><strong class="text-cosmic-pink">333:</strong> Spiritual growth - The ascended masters are supporting your journey</li>
                    <li><strong class="text-cosmic-pink">444:</strong> Protection and encouragement - Your angels are surrounding you with love</li>
                    <li><strong class="text-cosmic-pink">555:</strong> Major life changes - Transformation and freedom are coming</li>
                    <li><strong class="text-cosmic-pink">777:</strong> Spiritual awakening - You're on the right path to enlightenment</li>
                    <li><strong class="text-cosmic-pink">888:</strong> Abundance and success - Financial prosperity is manifesting</li>
                    <li><strong class="text-cosmic-pink">999:</strong> Completion and new chapters - One door closes, another opens</li>
                </ul>

                <h3 class="font-serif text-2xl text-cosmic-gold mt-8 mb-4">Why Track Your Angel Number Sightings?</h3>
                <p>
                    Using our angel number tracker helps you identify patterns in the divine messages you're receiving. By logging when and where you see specific angel numbers, along with your thoughts and feelings in those moments, you can better understand what the universe is trying to communicate to you. This practice deepens your spiritual awareness and helps you recognize synchronicities in your daily life.
                </p>

                <p class="text-lg font-semibold text-cosmic-gold mt-8">
                    Start your spiritual journey today with our free angel number calculator and trackerâ€”no signup required!
                </p>
            </div>
        </div>
    </section>


                        Soulcodes was born from a desire to create a sacred, digital space for women on their spiritual journey. We are here to remind you of your power, your divinity, and your infinite connection to the cosmos.
                </p>
                <p>
                    These tools are not a distraction; they are a focal point. A way to anchor your intentions, connect with your higher self, and receive the wisdom that is already within you. Use this space as a daily ritual to raise your vibration and consciously create your reality.
                </p>
            </div>
        </section>

    </main>

    <!-- ===== Footer ===== -->
    <footer class="text-center p-10 bg-black/50 backdrop-blur-lg border-t border-cosmic-purple/30">
        <p class="font-sans text-gray-400">
            Â© <span id="footer-year">2025</span> Soulcodes - Connect With Your Higher Self.
        </p>
    </footer>

    <!-- ===== JavaScript Logic (now using Supabase) ===== -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        // Supabase initialization
        const SUPABASE_URL = 'YOUR_SUPABASE_URL'; // Replace with your Supabase project URL
        const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY'; // Replace with your Supabase anon key
        const supabaseClient = Supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Brevo API configuration
        window.BREVO_API_KEY = window.BREVO_API_KEY || null;
        window.BREVO_LIST_ID = window.BREVO_LIST_ID || null;

        // Dynamic Firebase imports - will fail gracefully if CDN is blocked
        let initializeApp, getAuth, signInAnonymously, signInWithCustomToken, getFirestore, doc, setDoc, onSnapshot;

        async function loadFirebase() {
            try {
                const firebaseApp = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js");
                const firebaseAuth = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");
                const firebaseFirestore = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js");

                initializeApp = firebaseApp.initializeApp;
                getAuth = firebaseAuth.getAuth;
                signInAnonymously = firebaseAuth.signInAnonymously;
                signInWithCustomToken = firebaseAuth.signInWithCustomToken;
                getFirestore = firebaseFirestore.getFirestore;
                doc = firebaseFirestore.doc;
                setDoc = firebaseFirestore.setDoc;
                onSnapshot = firebaseFirestore.onSnapshot;

                return true;
            } catch (error) {
                console.warn('Firebase modules failed to load:', error);
                return false;
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {

            // Try to load Firebase

    // --- Dynamic Starfield - Initialize container reference early ---
    function createStars() {
        let starsContainer = document.getElementById('stars-container');
        
        // If container doesn't exist, create it
        if (!starsContainer) {
            starsContainer = document.createElement('div');
            starsContainer.id = 'stars-container';
            starsContainer.className = starsContainer.className =
  'fixed top-0 left-0 w-full h-full z-0 opacity-100 pointer-events-none';

            document.body.appendChild(starsContainer);
        }

        starsContainer.innerHTML = ''; // Clear existing stars
        for (let i = 0; i < 200; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            const size = Math.random() * 3 + 1; // Make stars slightly larger and more visible
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.opacity = Math.random() * 0.8 + 0.2; // Random opacity between 0.2 and 1
            star.style.animationDelay = `${Math.random() * 3}s`;
            star.style.animationDuration = `${Math.random() * 2 + 1.5}s`;
            starsContainer.appendChild(star);
        }
    }

    // Generate stars after a short delay to ensure DOM is ready
    setTimeout(createStars, 100);
    
    // Also regenerate stars if window is resized
    window.addEventListener('resize', createStars);

            const firebaseLoaded = await loadFirebase();

            // --- Element References ---
            const saveStatus = document.getElementById('save-status');
            const journalInput = document.getElementById('journal-input');
            const saveButton = document.getElementById('save-journal-button');
            const journalPromptEl = document.getElementById('journal-prompt');

            // --- Firebase Initialization and Auth ---
            // Global variables provided by the Canvas environment

           const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
const appId = (firebaseConfig && firebaseConfig.appId) ? firebaseConfig.appId : 'soulcodes';

let db = null;
let userId = null;
let journalDocRef = null;


            if (firebaseLoaded && firebaseConfig && typeof initializeApp !== 'undefined') {
                try {
                    const app = initializeApp(firebaseConfig);
                    const auth = getAuth(app);
                    db = getFirestore(app);

                    // 1. Authenticate
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                    userId = auth.currentUser?.uid || 'anonymous';

                    // 2. Define document path for private journal data
                    // Path: /artifacts/{appId}/users/{userId}/journal_entries/daily_ritual
                    journalDocRef = doc(db, 'artifacts', appId, 'users', userId, 'journal_entries', 'daily_ritual');

                    // 3. Load: Set up real-time listener (onSnapshot)
                    onSnapshot(journalDocRef, (docSnap) => {
                        if (docSnap.exists()) {
                            const data = docSnap.data();
                            // Only update the input field if the retrieved data is valid
                            if (data && data.entry) {
                                journalInput.value = data.entry;
                            }
                        } else {
                            // Document does not exist yet (first time use)
                            journalInput.value = '';
                        }
                    }, (error) => {
                        console.error("Firestore Load Error:", error);
                        saveStatus.textContent = "Error loading ritual. Check console.";
                    });

                    // 4. Save: Use setDoc on button click
                    saveButton.addEventListener('click', async () => {
                        const entryData = {
                            entry: journalInput.value,
                            timestamp: Date.now(),
                            prompt: journalPromptEl.textContent
                        };

                        try {
                            // setDoc with merge: true creates the document if it doesn't exist or updates fields if it does.
                            await setDoc(journalDocRef, entryData, { merge: true });

                            saveStatus.textContent = 'Ritual saved successfully to the cosmos.';
                            setTimeout(() => {
                                saveStatus.textContent = '';
                            }, 3000);
                        } catch (e) {
                            console.error("Error saving ritual: ", e);
                            saveStatus.textContent = 'Error saving ritual. Check console.';
                        }
                    });

                } catch (error) {
                    console.error("Critical Firebase Setup Error:", error);
                    saveStatus.textContent = "A critical error occurred connecting to the database.";
                }

            } else {
                 // Fallback to local storage if Firebase config is unavailable (not persistent/collaborative)
                 console.warn("Firebase configuration missing. Journal data is currently NOT persistent.");
                 journalInput.value = localStorage.getItem('soulcodeJournal') || '';
                 saveButton.addEventListener('click', () => {
                     localStorage.setItem('soulcodeJournal', journalInput.value);
                     saveStatus.textContent = 'Ritual saved locally (not to database).';
                     setTimeout(() => { saveStatus.textContent = ''; }, 3000);
                 });
            }

            // --- Card Deck Logic ---
            const affirmations = [
                "I am a radiant being of light, love, and infinite potential.",
                "I release all that no longer serves my highest good.",
                "My intuition is my most trusted guide, and I follow it fearlessly.",
                "I am worthy of all the abundance and joy the universe has to offer.",
                "I am aligned with my soul's purpose and divine mission.",
                "I choose love over fear in every thought, word, and action.",
                "I am a powerful creator, and I consciously shape my reality.",
                "My body is a sacred temple, and I honor it with love and care.",
                "I see the divine in all beings, including myself.",
                "I am grounded, centered, and connected to the earth and the cosmos.",
                "I forgive myself and others, freeing my energy for creation.",
                "Every challenge is an opportunity for me to grow and expand my consciousness.",
            ];

            const cardContainer = document.getElementById('card-container');
            const affirmationText = document.getElementById('affirmation-text');
            const drawNewCardButton = document.getElementById('draw-new-card-button');

            function drawNewAffirmation() {
                const newAffirmation = affirmations[Math.floor(Math.random() * affirmations.length)];
                affirmationText.textContent = newAffirmation;
            }

            // Card flip functionality with improved handling
            if (cardContainer) {
                let isFlipping = false; // Prevent rapid clicks
                
                cardContainer.addEventListener('click', function(e) {
                    // Prevent flipping if animation is in progress
                    if (isFlipping) return;
                    
                    isFlipping = true;
                                                console.log('Card flip initiated');
                    
                    // Toggle the flipped class
                    cardContainer.classList.toggle('flipped');
                    
                    // If card is being flipped to the back and hasn't been initialized yet
                    if (cardContainer.classList.contains('flipped') && 
                        (affirmationText.textContent === "Your divine message is loading..." ||
                         affirmationText.textContent.trim() === "" ||
                         affirmationText.textContent.includes("loading"))) {
                        drawNewAffirmation();
                    }
                    
                    // Reset the flipping flag after animation completes
                    setTimeout(() => {
                        isFlipping = false;
                    }, 1000); // Match the CSS transition duration
                });
            } else {
                console.error('Card container element not found!');
            }

            drawNewCardButton.addEventListener('click', () => {
                // Draw new affirmation and ensure card is flipped to show it
                drawNewAffirmation();
                
                // Make sure card is flipped to back to show the new affirmation
                if (cardContainer && !cardContainer.classList.contains('flipped')) {
                    cardContainer.classList.add('flipped');
                }
            });


                    // --- Connect Banner Buttons ---

    const affirmationBtn = document.getElementById('btn-affirmation');
    const angelNumbersBtn = document.getElementById('btn-angel-numbers');
    const lifePathBtn = document.getElementById('btn-life-path');

    if (affirmationBtn) {
      affirmationBtn.addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('card-deck')?.scrollIntoView({
          behavior: 'smooth',
          block: 'start',
        });
      });
    }

    if (angelNumbersBtn) {
      angelNumbersBtn.addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('angel-calculator')?.scrollIntoView({
          behavior: 'smooth',
          block: 'start',
        });
      });
    }

    if (lifePathBtn) {
      lifePathBtn.addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('life-path-calculator')?.scrollIntoView({
          behavior: 'smooth',
          block: 'start',
        });
      });
    }
            // --- Navigation Smooth Scroll ---
            const navLinks = document.querySelectorAll('a[href^=\"#\"]');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');

            // Smooth scroll for all nav links
            [...navLinks, ...mobileNavLinks].forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href');
                    const targetSection = document.querySelector(targetId);

                    if (targetSection) {
                        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                        // Close mobile menu if open
                        if (mobileMenu.classList.contains('translate-y-0')) {
                            mobileMenu.classList.remove('translate-y-0');
                            mobileMenu.classList.add('-translate-y-full');
                        }
                    }
                });
            });

            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', () => {
                if (mobileMenu.classList.contains('-translate-y-full')) {
                    mobileMenu.classList.remove('-translate-y-full');
                    mobileMenu.classList.add('translate-y-0');
                } else {
                    mobileMenu.classList.remove('translate-y-0');
                    mobileMenu.classList.add('-translate-y-full');
                }
            });

            // --- Brevo Email API Integration ---
            const emailForm = document.getElementById('email-signup-form');
            const emailInput = document.getElementById('email-input');
            const emailStatus = document.getElementById('email-status');

            // Get Brevo API key from environment variable (set in your hosting platform)
          emailForm.addEventListener('submit', async (e) => {

    e.preventDefault();
    
    const email = emailInput.value.trim();
    const name = document.getElementById('name-input').value.trim();
    
    if (!email || !name) {
        emailStatus.textContent = 'Please fill in all fields.';
        emailStatus.className = 'text-sm text-center mt-2 text-red-400';
        return;
    }
    
    emailStatus.textContent = 'Subscribing...';
    emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
    
    try {
        // Call your Netlify serverless function
        const response = await fetch('/.netlify/functions/subscribe', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                email: email,
                name: name
            })
        });
        
        const data = await response.json();
        
        if (response.ok) {
            emailStatus.textContent = 'âœ¨ Welcome! Check your inbox for confirmation.';
            emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
            emailInput.value = '';
            document.getElementById('name-input').value = '';
        } else {
            throw new Error(data.error || 'Subscription failed');
        }
    } catch (error) {
        console.error('Subscription error:', error);
        emailStatus.textContent = 'Something went wrong. Please try again.';
        emailStatus.className = 'text-sm text-center mt-2 text-red-400';
    }
});


                        if (response.ok || response.status === 201) {
                            emailStatus.textContent = 'âœ¨ Welcome! Check your inbox for confirmation.';
                            emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                            emailInput.value = '';

                            // Track in Firebase if available
                            if (typeof db !== 'undefined' && db && typeof journalDocRef !== 'undefined' && journalDocRef) {
                                await setDoc(doc(db, 'artifacts', appId, 'subscribers', email.replace('@', '_at_')), {
                                    email: email,
                                    subscribedAt: Date.now(),
                                    source: 'homepage'
                                });
                            }
                        } else {
                            throw new Error('Subscription failed');
                        }
                    } catch (error) {
                        console.error('Brevo API Error:', error);
                        emailStatus.textContent = 'Something went wrong. Please try again.';
                        emailStatus.className = 'text-sm text-center mt-2 text-red-400';
                    }
                } else {
                    // Fallback: Store in Firebase or localStorage
                    console.warn('Brevo API key not configured. Storing email locally.');

                    if (typeof db !== 'undefined' && db) {
                        try {
                            await setDoc(doc(db, 'artifacts', appId, 'subscribers', email.replace('@', '_at_')), {
                                email: email,
                                subscribedAt: Date.now(),
                                source: 'homepage'
                            });
                            emailStatus.textContent = 'âœ¨ Thanks for your interest! We\'ll be in touch soon.';
                            emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                            emailInput.value = '';
                        } catch (error) {
                            console.error('Firebase Error:', error);
                            // Fallback to Supabase or localStorage
                            if (typeof supabaseClient !== 'undefined' && supabaseClient) {
                                try {
                                    // Store in Supabase
                                    const { error } = await supabaseClient
                                        .from('subscribers')
                                        .insert([{
                                            email: email,
                                            name: name,
                                            subscribed_at: new Date().toISOString(),
                                            source: 'homepage'
                                        }]);

                                    if (error) {
                                        throw error;
                                    }

                                    emailStatus.textContent = 'âœ¨ Thanks! We\'ll be in touch soon.';
                                    emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                                    emailInput.value = '';
                                    const nameInput = document.getElementById('name-input');
                                    if (nameInput) nameInput.value = '';
                                } catch (error) {
                                    console.error('Supabase Error:', error);
                                    // Fallback to localStorage
                                    const emails = JSON.parse(localStorage.getItem('emailSubscribers') || '[]');
                                    if (!emails.includes(email)) {
                                        emails.push(email);
                                        localStorage.setItem('emailSubscribers', JSON.stringify(emails));
                                    }
                                    emailStatus.textContent = 'âœ¨ Thanks! We\'ll be in touch soon.';
                                    emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                                    emailInput.value = '';
                                    const nameInput = document.getElementById('name-input');
                                    if (nameInput) nameInput.value = '';
                                }
                            } else {
                                // Fallback to localStorage
                                const emails = JSON.parse(localStorage.getItem('emailSubscribers') || '[]');
                                if (!emails.includes(email)) {
                                    emails.push(email);
                                    localStorage.setItem('emailSubscribers', JSON.stringify(emails));
                                }
                                emailStatus.textContent = 'âœ¨ Thanks! We\'ll be in touch soon.';
                                emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                                emailInput.value = '';
                                const nameInput = document.getElementById('name-input');
                                if (nameInput) nameInput.value = '';
                            }
                        }
                    } else {
                        // Fallback to Supabase or localStorage
                        if (typeof supabaseClient !== 'undefined' && supabaseClient) {
                            try {
                                // Store in Supabase
                                const { error } = await supabaseClient
                                    .from('subscribers')
                                    .insert([{
                                        email: email,
                                        name: name,
                                        subscribed_at: new Date().toISOString(),
                                        source: 'homepage'
                                    }]);

                                if (error) {
                                    throw error;
                                }

                                emailStatus.textContent = 'âœ¨ Thanks! We\'ll be in touch soon.';
                                emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                                emailInput.value = '';
                                const nameInput = document.getElementById('name-input');
                                if (nameInput) nameInput.value = '';
                            } catch (error) {
                                console.error('Supabase Error:', error);
                                // Fallback to localStorage
                                const emails = JSON.parse(localStorage.getItem('emailSubscribers') || '[]');
                                if (!emails.includes(email)) {
                                    emails.push(email);
                                    localStorage.setItem('emailSubscribers', JSON.stringify(emails));
                                }
                                emailStatus.textContent = 'âœ¨ Thanks! We\'ll be in touch soon.';
                                emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                                emailInput.value = '';
                                const nameInput = document.getElementById('name-input');
                                if (nameInput) nameInput.value = '';
                            }
                        } else {
                            // Last fallback: localStorage only
                            const emails = JSON.parse(localStorage.getItem('emailSubscribers') || '[]');
                            if (!emails.includes(email)) {
                                emails.push(email);
                                localStorage.setItem('emailSubscribers', JSON.stringify(emails));
                            }
                            emailStatus.textContent = 'âœ¨ Thanks! We\'ll be in touch soon.';
                            emailStatus.className = 'text-sm text-center mt-2 text-cosmic-gold';
                            emailInput.value = '';
                            const nameInput = document.getElementById('name-input');
                            if (nameInput) nameInput.value = '';
                        }
                    }
                }
            });

            // --- Daily Ritual Dashboard (Non-DB Logic) ---

            // 1. Moon Phase
            const moonPhaseIconEl = document.getElementById('moon-phase-icon');
            const moonPhaseNameEl = document.getElementById('moon-phase-name');
            const moonIcons = ['ðŸŒ‘', 'ðŸŒ’', 'ðŸŒ“', 'ðŸŒ”', 'ðŸŒ•', 'ðŸŒ–', 'ðŸŒ—', 'ðŸŒ˜'];
            const moonNames = ['New Moon', 'Waxing Crescent', 'First Quarter', 'Waxing Gibbous', 'Full Moon', 'Waning Gibbous', 'Third Quarter', 'Waning Crescent'];

        // Calculate moon phase using astronomical algorithm
        function getMoonPhase() {
          const today = new Date();
          const year = today.getFullYear();
          const month = today.getMonth() + 1;
          const day = today.getDate();

          // Corrected Julian day calculation (removed extra constant)
          let jd = 367 * year - Math.floor(7 * (year + Math.floor((month + 9) / 12)) / 4) +
                   Math.floor(275 * month / 9) + day;

          // Days since known new moon (Jan 6, 2000)
          const daysSinceNew = jd - 2451549.5;

          // Moon phase calculation
          const lunarCycle = 29.53058867; // Length of synodic month
          const newMoons = daysSinceNew / lunarCycle;

          let phase = (newMoons - Math.floor(newMoons));
          
          // Ensure phase is positive
          if (phase < 0) phase += 1;

          // Convert to 0-7 index
          const phaseIndex = Math.floor(phase * 8) % 8;

          return phaseIndex;
        }

        const phaseIndex = getMoonPhase();
        if (moonPhaseIconEl && moonPhaseNameEl) {
            moonPhaseIconEl.textContent = moonIcons[phaseIndex];
            moonPhaseNameEl.textContent = moonNames[phaseIndex];
        }

            // 2. Angel Number
            const angelNumberEl = document.getElementById('angel-number');
            const angelNumbers = ['111', '222', '333', '444', '555', '777', '888', '999'];
            angelNumberEl.textContent = angelNumbers[Math.floor(Math.random() * angelNumbers.length)];

            // 3. Journal Prompt
            const prompts = [
                "What limiting belief am I ready to release today?",
                "How can I show myself unconditional love in this moment?",
                "What is my soul whispering to me?",
                "Where in my life am I being called to be more authentic?",
                "What am I most grateful for in my spiritual journey right now?",
                "How can I raise my vibration today?",
            ];

            journalPromptEl.textContent = prompts[Math.floor(Math.random() * prompts.length)];

            // --- Footer Year ---
            document.getElementById('footer-year').textContent = new Date().getFullYear();

    // ===== USER PROFILE SYSTEM =====
    const profileModal = document.getElementById('profile-modal');
    const profileForm = document.getElementById('profile-form');
    const personalizedGreeting = document.getElementById('personalized-greeting');

    // Check if user has a profile
    function checkUserProfile() {
        const userProfile = JSON.parse(localStorage.getItem('soulcodesProfile'));

        if (!userProfile) {
            // Show profile modal after 3 seconds on first visit
            setTimeout(() => {
                profileModal.classList.remove('hidden');
            }, 3000);
        } else {
            // Show personalized greeting
            showPersonalizedGreeting(userProfile);
        }
    }

    // Save user profile
    profileForm.addEventListener('submit', (e) => {
        e.preventDefault();

        const profile = {
            name: document.getElementById('profile-name').value,
            birthdate: document.getElementById('profile-birthdate').value,
            goal: document.getElementById('profile-goal').value,
            numbers: document.getElementById('profile-numbers').value,
            createdAt: Date.now()
        };

        // Calculate life path number
        profile.lifePathNumber = calculateLifePath(profile.name, profile.birthdate);

        localStorage.setItem('soulcodesProfile', JSON.stringify(profile));
        profileModal.classList.add('hidden');
        showPersonalizedGreeting(profile);
    });

    // Show personalized greeting
    function showPersonalizedGreeting(profile) {
        document.getElementById('user-name-display').textContent = profile.name.split(' ')[0];
        document.getElementById('user-life-path').textContent = profile.lifePathNumber;

        // Calculate days since signup
        const daysSince = Math.floor((Date.now() - profile.createdAt) / (1000 * 60 * 60 * 24));
        document.getElementById('days-since-signup').textContent = daysSince;

        personalizedGreeting.classList.remove('hidden');
    }

    // Initialize profile check on page load
    checkUserProfile();



            // Initial call for first-time card load
            drawNewAffirmation();
            
            // Also make sure the card is properly initialized with an affirmation
            if (affirmationText && (affirmationText.textContent === "Your divine message is loading..." ||
                affirmationText.textContent.trim() === "" ||
                !affirmationText.textContent)) {
                drawNewAffirmation();
            }

            // ===== Angel Number Calculator =====
    const angelMeanings = {
        1: "New beginnings, independence, and manifesting your desires. The universe is supporting your new path.",
        2: "Balance, harmony, and partnerships. Trust in divine timing and maintain faith.",
        3: "Creativity, self-expression, and growth. The ascended masters are guiding you.",
        4: "Stability, hard work paying off, and angelic protection. You're on the right path.",
        5: "Change, freedom, and adventure. Major life transformations are coming.",
        6: "Love, family, and domestic harmony. Focus on balance between material and spiritual.",
        7: "Spiritual awakening, inner wisdom, and good fortune. You're aligned with your soul's purpose.",
        8: "Abundance, success, and infinite possibilities. Financial and personal power are manifesting.",
        9: "Completion, humanitarian service, and spiritual enlightenment. A chapter is ending to make way for new beginnings.",
        11: "Master number of intuition, spiritual insight, and enlightenment. Your thoughts are rapidly manifesting.",
        22: "Master number of the master builder. You have the power to turn dreams into reality.",
        33: "Master number of compassion and blessings. You're being called to uplift others through your gifts."
    };

    function calculateAngelNumber(name, birthdate) {
        // Calculate from name (Pythagorean numerology)
        const letterValues = {
            'a': 1, 'b': 2, 'c': 3, 'd': 4, 'e': 5, 'f': 6, 'g': 7, 'h': 8, 'i': 9,
            'j': 1, 'k': 2, 'l': 3, 'm': 4, 'n': 5, 'o': 6, 'p': 7, 'q': 8, 'r': 9,
            's': 1, 't': 2, 'u': 3, 'v': 4, 'w': 5, 'x': 6, 'y': 7, 'z': 8
        };

        let nameSum = 0;
        name.toLowerCase().split('').forEach(char => {
            if (letterValues[char]) {
                nameSum += letterValues[char];
            }
        });

        // Calculate from birthdate
        const dateSum = birthdate.split('-').join('').split('').reduce((sum, digit) => sum + parseInt(digit), 0);

        // Combine and reduce
        let total = nameSum + dateSum;

        // Reduce to single digit or master number (11, 22, 33)
        while (total > 33 && total !== 11 && total !== 22 && total !== 33) {
            total = total.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
        }

        // If still not a master number, reduce to single digit
        if (total > 9 && total !== 11 && total !== 22 && total !== 33) {
            total = total.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
        }

        return total;
    }

    const calculateButton = document.getElementById('calculate-angel-number');
    const angelResult = document.getElementById('angel-result');
    const angelNumberDisplay = document.getElementById('angel-number-display');
    const angelMeaningText = document.getElementById('angel-meaning');

    calculateButton.addEventListener('click', () => {
        const name = document.getElementById('calc-name').value.trim();
        const birthdate = document.getElementById('calc-birthdate').value;

        if (!name || !birthdate) {
            alert('Please enter both your name and birthdate');
            return;
        }

        const angelNumber = calculateAngelNumber(name, birthdate);
        angelNumberDisplay.textContent = angelNumber;
        angelMeaningText.textContent = angelMeanings[angelNumber] || angelMeanings[angelNumber % 10];
        angelResult.classList.remove('hidden');
    });

    // ===== Angel Number Tracker =====
    const sightingsList = document.getElementById('sightings-list');
    const logSightingButton = document.getElementById('log-sighting');

    function loadSightings() {
        const sightings = JSON.parse(localStorage.getItem('angelSightings') || '[]');

        if (sightings.length === 0) {
            sightingsList.innerHTML = '<p class="text-gray-400 text-center italic">No sightings recorded yet. Start tracking your divine messages!</p>';
            return;
        }

        sightingsList.innerHTML = sightings.map((sighting, index) => `
            <div class="bg-white/5 rounded-xl p-4 border border-cosmic-purple/30 hover:border-cosmic-gold/50 transition-all">
                <div class="flex justify-between items-start mb-2">
                    <div class="flex-1">
                        <span class="font-serif text-3xl text-cosmic-gold text-shadow-glow-gold">${sighting.number}</span>
                        <span class="text-gray-400 text-sm ml-3">${new Date(sighting.datetime).toLocaleString()}</span>
                    </div>
                    <button onclick="deleteSighting(${index})" class="text-red-400 hover:text-red-300 text-sm">
                        Delete
                    </button>
                </div>
                ${sighting.location ? `<p class="text-gray-300 text-sm mb-1"><span class="text-cosmic-pink">ðŸ“</span> ${sighting.location}</p>` : ''}
                ${sighting.notes ? `<p class="text-gray-400 text-sm italic mt-2">${sighting.notes}</p>` : ''}
            </div>
        `).reverse().join('');
    }

    window.deleteSighting = function(index) {
        if (confirm('Are you sure you want to delete this sighting?')) {
            const sightings = JSON.parse(localStorage.getItem('angelSightings') || '[]');
            sightings.splice(index, 1);
            localStorage.setItem('angelSightings', JSON.stringify(sightings));
            loadSightings();
        }
    };

    logSightingButton.addEventListener('click', () => {
        const number = document.getElementById('sighting-number').value.trim();
        const datetime = document.getElementById('sighting-datetime').value;
        const location = document.getElementById('sighting-location').value.trim();
        const notes = document.getElementById('sighting-notes').value.trim();

        if (!number || !datetime) {
            alert('Please enter at least the angel number and date/time');
            return;
        }

        const sightings = JSON.parse(localStorage.getItem('angelSightings') || '[]');
        sightings.push({ number, datetime, location, notes, timestamp: Date.now() });
        localStorage.setItem('angelSightings', JSON.stringify(sightings));

        // Clear form
        document.getElementById('sighting-number').value = '';
        document.getElementById('sighting-datetime').value = '';
        document.getElementById('sighting-location').value = '';
        document.getElementById('sighting-notes').value = '';

        loadSightings();
    });

    // Set current datetime as default
    const now = new Date();
    now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
    document.getElementById('sighting-datetime').value = now.toISOString().slice(0, 16);

    // Load existing sightings
    loadSightings();

                  // ===== Life Path Calculator =====
  const lifePathMeanings = {
    1: "You are a natural leader and pioneer. Your path is about independence, innovation, and being first. You're meant to forge new paths and inspire others with your courage.",
    2: "You are the peacemaker and diplomat. Your purpose involves creating harmony, building partnerships, and bringing people together. You excel at cooperation and sensitivity.",
    3: "You are the creative communicator. Your life path is about self-expression, joy, and inspiring others through art, words, or performance. You bring light and optimism to the world.",
    4: "You are the builder and organizer. Your path involves creating solid foundations, bringing order to chaos, and manifesting dreams through hard work and dedication.",
    5: "You are the freedom seeker and adventurer. Your purpose is about experiencing life fully, embracing change, and helping others break free from limitations.",
    6: "You are the nurturer and healer. Your path centers on love, family, community service, and creating beauty and harmony in the world around you.",
    7: "You are the seeker of truth and wisdom. Your journey involves deep spiritual understanding, analysis, and sharing knowledge with the world.",
    8: "You are the manifestor of abundance. Your path is about material success, leadership in business, and using your power to create positive change in the world.",
    9: "You are the humanitarian and universal lover. Your purpose is about compassion, letting go, and serving humanity on a grand scale.",
    11: "Master Number - You are a spiritual messenger and illuminator. Your path involves inspiring others through your intuition and bringing divine light to the world.",
    22: "Master Number - You are the master builder. Your purpose is to manifest grand visions and create lasting structures that benefit humanity.",
    33: "Master Number - You are the master teacher. Your path involves healing through love, teaching spiritual truths, and uplifting humanity."
  };

  function calculateLifePath(name, birthdate) {
    // Extract the date components
    const dateParts = birthdate.split('-');
    if (dateParts.length !== 3) {
      console.error('Invalid birthdate format. Expected YYYY-MM-DD');
      return 0;
    }
    
    const year = parseInt(dateParts[0]);
    const month = parseInt(dateParts[1]);
    const day = parseInt(dateParts[2]);

    // Calculate the life path number by adding all digits of birthdate
    let total = 0;
    
    // Add all digits of the year
    total += year.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
    // Add all digits of the month
    total += month.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
    // Add all digits of the day
    total += day.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);

    // Reduce to a single digit or master number (11, 22, 33)
    // Don't reduce master numbers unless they appear after adding date components
    while (total > 33 && total !== 11 && total !== 22 && total !== 33) {
      total = total.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
    }

    // If the total is still greater than 9 but not a master number, reduce further
    if (total > 9 && total !== 11 && total !== 22 && total !== 33) {
      total = total.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
    }

    return total;
}



  const calculateLifePathButton = document.getElementById('calculate-life-path');
  const lifePathResult = document.getElementById('lifepath-result');
  const lifePathNumberDisplay = document.getElementById('lifepath-number');
  const lifePathMeaningText = document.getElementById('lifepath-meaning');

  calculateLifePathButton.addEventListener('click', () => {
    const name = document.getElementById('lifepath-name').value.trim();
    const birthdate = document.getElementById('lifepath-birthdate').value;

    if (!name || !birthdate) {
      alert('Please enter both your name and birthdate');
      return;
    }

    const lifePathNumber = calculateLifePath(name, birthdate);
    lifePathNumberDisplay.textContent = lifePathNumber;
    lifePathMeaningText.textContent = lifePathMeanings[lifePathNumber] || lifePathMeanings[lifePathNumber % 10];
    lifePathResult.classList.remove('hidden');

    // Scroll to results
    lifePathResult.scrollIntoView({ behavior: 'smooth', block: 'center' });
  });

  /* ===== Supabase Integration =====
  // Initialize Supabase client
  const SUPABASE_URL = 'https://your-project.supabase.co'; // Replace with your Supabase URL
  const SUPABASE_ANON_KEY = 'your-anon-key'; // Replace with your Supabase anon key

  const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // Enhanced profile modal with Supabase integration
  profileForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const profile = {
      name: document.getElementById('profile-name').value,
      birthdate: document.getElementById('profile-birthdate').value,
      goal: document.getElementById('profile-goal').value,
      numbers: document.getElementById('profile-numbers').value,
      createdAt: new Date().toISOString()
    };

    try {
      // Store in Supabase
      const { data, error } = await supabaseClient
        .from('profiles')
        .insert([profile]);

      if (error) throw error;

      // Calculate and store life path number
      profile.lifePathNumber = calculateLifePath(profile.name, profile.birthdate);

      localStorage.setItem('soulcodesProfile', JSON.stringify(profile));
      profileModal.classList.add('hidden');
      showPersonalizedGreeting(profile);
    } catch (err) {
      console.error('Error saving profile:', err.message);
      alert('There was an error saving your profile. Please try again.');
    }
  });

  // Enhanced angel number tracker with Supabase integration
  logSightingButton.addEventListener('click', async () => {
    const number = document.getElementById('sighting-number').value.trim();
    const datetime = document.getElementById('sighting-datetime').value;
    const location = document.getElementById('sighting-location').value.trim();
    const notes = document.getElementById('sighting-notes').value.trim();

    if (!number || !datetime) {
      alert('Please enter at least the angel number and date/time');
      return;
    }

    const sighting = {
      number,
      datetime,
      location,
      notes,
      timestamp: new Date().toISOString(),
      user_id: 'temp_user' // This would be replaced with actual user ID when auth is implemented
    };

    try {
      // Store in Supabase
      const { data, error } = await supabaseClient
        .from('angel_sightings')
        .insert([sighting]);

      if (error) throw error;

      // Clear form
      document.getElementById('sighting-number').value = '';
      document.getElementById('sighting-datetime').value = '';
      document.getElementById('sighting-location').value = '';
      document.getElementById('sighting-notes').value = '';

      loadSightings(); // Reload sightings from Supabase
    } catch (err) {
      console.error('Error saving sighting:', err.message);
      alert('There was an error saving your sighting. Saving locally instead.');

      // Fallback to localStorage
      const sightings = JSON.parse(localStorage.getItem('angelSightings') || '[]');
      sightings.push(sighting);
      localStorage.setItem('angelSightings', JSON.stringify(sightings));
      loadSightings();
    }
  });

  // Update loadSightings to fetch from Supabase with fallback
  async function loadSightings() {
    let sightings = [];

    try {
      // Try to fetch from Supabase
      const { data, error } = await supabaseClient
        .from('angel_sightings')
        .select('*')
        .order('timestamp', { ascending: false });

      if (error) throw error;
      sightings = data || [];
    } catch (err) {
      console.error('Error fetching sightings from Supabase:', err.message);
      // Fallback to localStorage
      sightings = JSON.parse(localStorage.getItem('angelSightings') || '[]');
    }

    if (sightings.length === 0) {
      sightingsList.innerHTML = '<p class="text-gray-400 text-center italic">No sightings recorded yet. Start tracking your divine messages!</p>';
      return;
    }

    sightingsList.innerHTML = sightings.map((sighting, index) => `
      <div class="bg-white/5 rounded-xl p-4 border border-cosmic-purple/30 hover:border-cosmic-gold/50 transition-all">
        <div class="flex justify-between items-start mb-2">
          <div class="flex-1">
            <span class="font-serif text-3xl text-cosmic-gold text-shadow-glow-gold">${sighting.number}</span>
            <span class="text-gray-400 text-sm ml-3">${new Date(sighting.timestamp || sighting.datetime).toLocaleString()}</span>
          </div>
          <button onclick="deleteSighting(${index}, '${sighting.id}')" class="text-red-400 hover:text-red-300 text-sm">
            Delete
          </button>
        </div>
        ${sighting.location ? `<p class="text-gray-300 text-sm mb-1"><span class="text-cosmic-pink">ðŸ“</span> ${sighting.location}</p>` : ''}
        ${sighting.notes ? `<p class="text-gray-400 text-sm italic mt-2">${sighting.notes}</p>` : ''}
      </div>
    `).join('');
  }

  // Enhanced deleteSighting with Supabase integration
  window.deleteSighting = async function(index, sightingId) {
    if (confirm('Are you sure you want to delete this sighting?')) {
      try {
        // Try to delete from Supabase if we have a valid ID
        if (sightingId && sightingId !== 'local') {
          const { error } = await supabaseClient
            .from('angel_sightings')
            .delete()
            .match({ id: sightingId });

          if (error) throw error;
        } else {
          // Fallback to localStorage deletion
          const sightings = JSON.parse(localStorage.getItem('angelSightings') || '[]');
          sightings.splice(index, 1);
          localStorage.setItem('angelSightings', JSON.stringify(sightings));
        }

        loadSightings(); // Reload sightings
      } catch (err) {
        console.error('Error deleting sighting:', err.message);
        alert('There was an error deleting your sighting. Please try again.');
      }
    }
  };

  // Enhanced journal functionality with Supabase
  saveButton.addEventListener('click', async () => {
    const content = journalInput.value.trim();
    if (!content) {
      saveStatus.textContent = 'Please write something in your journal.';
      saveStatus.classList.remove('text-green-400');
      saveStatus.classList.add('text-red-400');
      return;
    }

    const journalEntry = {
      content,
      updated_at: new Date().toISOString(),
      user_id: 'temp_user' // This would be replaced with actual user ID when auth is implemented
    };

    try {
      // Store in Supabase
      const { data, error } = await supabaseClient
        .from('journal_entries')
        .upsert([journalEntry], { onConflict: ['user_id'] });

      if (error) throw error;

      saveStatus.textContent = 'Journal saved successfully!';
      saveStatus.classList.remove('text-red-400');
      saveStatus.classList.add('text-green-400');
    } catch (err) {
      console.error('Error saving journal:', err.message);
      // Fallback to localStorage
      localStorage.setItem('soulcodesJournal', content);
      saveStatus.textContent = 'Journal saved locally (offline mode)';
      saveStatus.classList.remove('text-red-400');
      saveStatus.classList.add('text-yellow-400');
    }
  });

  // Initialize everything after DOM loads
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      createStars();
      drawNewAffirmation();
    });
  } else {
    createStars();
    drawNewAffirmation();
  }

  // ===== Brevo Email Integration =====
  // Handle email subscription form if it exists
  const emailForm = document.querySelector('#email-subscription-form') || document.querySelector('form[action*="brevo"], form[action*="sendinblue"]');
  if (emailForm) {
    emailForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const emailInput = emailForm.querySelector('input[type="email"]');
      if (!emailInput) {
        console.error('No email input found in form');
        return;
      }

      const email = emailInput.value;

      // Basic email validation
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        alert('Please enter a valid email address');
        return;
      }

      try {
        // In a real implementation, you would call Brevo's API here
        // For now, we'll simulate the subscription
        console.log('Subscribing email to Brevo:', email);

        // You would replace this with actual Brevo API call
        // Example:
        /*
        const response = await fetch('https://api.brevo.com/v3/contacts', {
          method: 'POST',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json',
            'API-Key': 'YOUR_BREVO_API_KEY'
          },
          body: JSON.stringify({
            email: email,
            attributes: {
              FIRSTNAME: '', // Could extract from form if available
              LASTNAME: ''
            },
            listIds: [1] // Replace with your actual list ID
          })
        });

        if (response.ok) {
          alert('Thank you for subscribing!');
          emailForm.reset();
        } else {
          throw new Error('Subscription failed');
        }
        */

        // Simulated success for now
        alert('Thank you for subscribing! (This is a simulation)');
        emailInput.value = '';
      } catch (error) {
        console.error('Email subscription error:', error);
        alert('There was an error processing your subscription. Please try again.');
      }
    });
  }
    </script>

                    <!-- Profile Modal -->
    <div id="profile-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-gradient-to-br from-cosmic-midnight via-cosmic-purple to-cosmic-midnight p-8 rounded-2xl max-w-lg w-full border-2 border-cosmic-gold shadow-2xl">
            <h2 class="text-3xl font-serif text-cosmic-gold mb-4 text-center">Create Your Soulcodes Profile</h2>
            <p class="text-gray-300 mb-6 text-center">Personalize your spiritual journey</p>
            <form id="profile-form" class="space-y-4">
                <div>
                    <label class="block text-cosmic-gold mb-2">Your Name</label>
                    <input type="text" id="profile-name" required class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
                </div>
                <div>
                    <label class="block text-cosmic-gold mb-2">Birth Date</label>
                    <input type="date" id="profile-birthdate" required class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
                </div>
                <div>
                    <label class="block text-cosmic-gold mb-2">What are you seeking guidance on?</label>
                    <select id="profile-goal" required class="w-full p-3 rounded-lg bg-white/10 text-white border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
                        <option value="">Select your focus...</option>
                        <option value="career">Career & Purpose</option>
                        <option value="love">Love & Relationships</option>
                        <option value="spiritual">Spiritual Growth</option>
                        <option value="abundance">Financial Abundance</option>
                        <option value="health">Health & Wellbeing</option>
                        <option value="transformation">Personal Transformation</option>
                    </select>
                </div>
                <div>
                    <label class="block text-cosmic-gold mb-2">Numbers you see frequently (optional)</label>
                    <input type="text" id="profile-numbers" placeholder="e.g., 111, 444, 777" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-gray-500 border border-cosmic-purple/30 focus:ring-2 focus:ring-cosmic-gold">
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-cosmic-purple to-cosmic-pink hover:from-cosmic-pink hover:to-cosmic-purple text-white font-bold py-3 px-6 rounded-full transition-all duration-300 transform hover:scale-105">
                    Start My Journey
                </button>
            </form>
        </div>
    </div>

    <!-- Personalized Greeting -->
    <div id="personalized-greeting" class="hidden fixed top-20 right-4 bg-gradient-to-br from-cosmic-purple/90 to-cosmic-midnight/90 backdrop-blur-sm p-6 rounded-xl border-2 border-cosmic-gold/50 shadow-2xl max-w-sm z-40">
        <p class="text-cosmic-gold text-lg mb-2">Welcome back, <span id="user-name-display" class="font-serif text-xl">âœ¨</span></p>
        <p class="text-gray-300 text-sm mb-1">Your Life Path Number: <span id="user-life-path" class="text-cosmic-pink font-bold"></span></p>
        <p class="text-gray-400 text-xs">Days on your journey: <span id="days-since-signup" class="text-cosmic-gold"></span></p>
    </div>
</body>

</html>
